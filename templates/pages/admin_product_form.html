{{ define "admin_product_form" }}
<section class="admin-page py-5">
    <div class="container">

        <h1 class="admin-title mb-1">
            Admin â€¢ {{ if .isEdit }}Edit Produk{{ else }}Tambah Produk{{ end }}
        </h1>
        <p class="admin-subtitle mb-4">
            Lengkapi detail produk supaya tampil rapi di katalog.
        </p>

        {{ if .success }}
        <div class="alert alert-success admin-alert mb-3">
            {{ index .success 0 }}
        </div>
        {{ end }}

        {{ if .error }}
        <div class="alert alert-danger admin-alert mb-3">
            {{ index .error 0 }}
        </div>
        {{ end }}

        <div class="pastel-card">
            <form method="POST" action="{{if .isEdit}}/admin/products/{{.product.ID}}{{else}}/admin/products{{end}}"
                enctype="multipart/form-data">

                <div class="form-row">
                    <div class="form-group col-md-8">
                        <label class="admin-label" for="name">Nama Produk</label>
                        <input type="text" class="form-control form-control-sm admin-input" id="name" name="name"
                            value="{{ if .product }}{{ .product.Name }}{{ end }}" required>
                    </div>
                    <div class="form-group col-md-4">
                        <label class="admin-label" for="stock">Stok</label>
                        <input type="number" min="0" class="form-control form-control-sm admin-input" id="stock"
                            name="stock" value="{{ if .product }}{{ .product.Stock }}{{ end }}" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label class="admin-label" for="price">Harga (Rp)</label>
                        <input type="number" step="0.01" min="0" class="form-control form-control-sm admin-input"
                            id="price" name="price" value="{{ if .product }}{{ .product.Price }}{{ end }}" required>
                    </div>

                    <div class="form-group">
                        <label for="size_options">Opsi Ukuran (pisahkan dengan koma)</label>
                        <input type="text" name="size_options" id="size_options" class="form-control" placeholder="Contoh: S,M,L,XL"
                            value="{{ .product.SizeOptions }}">
                    </div>
                    
                    <div class="form-group">
                        <label for="color_options">Opsi Warna (opsional, pisahkan dengan koma)</label>
                        <input type="text" name="color_options" id="color_options" class="form-control"
                            placeholder="Contoh: Hitam,Putih,Beige" value="{{ .product.ColorOptions }}">
                    </div>

                    <div class="form-group col-md-6">
                        <label class="admin-label" for="image">Gambar Produk</label>
                        <input type="file" name="image" id="image" class="form-control form-control-sm admin-input">
                        <small class="form-text text-muted">
                            Rekomendasi ukuran gambar: <strong>300 x 400 px</strong>
                        </small>

                        {{ if and .isEdit .product.ProductImages }}
                        <small class="form-text text-muted mt-2">Foto saat ini:</small>
                        <div class="mt-2">
                            {{ $first := index .product.ProductImages 0 }}
                            <img src="/public/uploads/{{ $first.Filename }}" alt="Current image"
                                style="max-height: 150px; border-radius:10px;">
                        </div>
                        {{ end }}
                    </div>
                </div>

                <div class="mt-4 d-flex justify-content-between">
                    <a href="/admin/products" class="btn-order-back">
                        Kembali
                    </a>
                    <button type="submit" class="btn-admin-primary">
                        {{ if .isEdit }}Simpan Perubahan{{ else }}Simpan Produk{{ end }}
                    </button>
                </div>
            </form>
        </div>

    </div>
</section>

<style>
    .admin-input {
        border-radius: 999px;
        border-color: var(--pastel-border);
        font-size: 0.9rem;
    }

    .admin-input:focus {
        border-color: var(--pastel-accent);
        box-shadow: 0 0 0 0.15rem rgba(129, 140, 248, 0.25);
    }

    .admin-label {
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: var(--text-muted);
    }

    .btn-order-back {
        border-radius: 999px;
        padding: 8px 16px;
        border: 1px solid var(--pastel-border);
        background: #f9fafb;
        color: var(--text-main);
        font-size: 0.85rem;
        text-decoration: none;
    }

    .btn-order-back:hover {
        background: #ede9fe;
        border-color: var(--pastel-accent);
        color: var(--pastel-accent);
    }
</style>
{{ end }}